# Little Score 产品功能说明

## 产品概述
- 面向家长与孩子的积分管理与激励工具，支持手机浏览器和微信内访问。
- 通过任务完成、评分、积分奖励与兑换，形成闭环激励。
- 内置 AI 语音助手，支持中文语音指令快速新增任务与积分兑换。

## 目标用户与场景
- **家长**：为孩子布置任务、记录完成情况、奖励积分、兑换奖励。
- **孩子**：查看积分、兑换奖励，获取即时反馈与激励。
- **家庭场景**：日常作业、阅读、家务、习惯养成等。

## 功能与用户操作
- **账号与安全**
  - 功能：邮箱+密码注册/登录，JWT 鉴权；管理员可开关注册入口。
  - 用户操作：在登录页完成注册或登录；管理员在系统设置中切换“允许注册”开关。

- **学生管理**
  - 功能：新增/编辑/删除学生，设定当前学生。
  - 用户操作：进入“我的”或学生管理入口，点击“添加学生”填写姓名；长按/编辑可修改或删除；在顶部学生选择器切换当前学生。

- **项目管理（一级/二级）**
  - 功能：自定义学科/习惯等一级项目，以及其下的二级任务分类。
  - 用户操作：在项目管理页点击“添加项目”，选择层级并可指定父级；编辑/删除以调整分类。

- **任务管理与积分增加**
  - 功能：创建任务，状态流转（进行中/已完成/惩罚等），支持评分等级（如 A*）；完成任务自动生成积分增加记录，可附奖励积分。
  - 用户操作：
    - 在任务页点击“新增任务”填写项目、评分、积分、状态。
    - 将任务状态改为“已完成”即生成积分记录；惩罚任务自动生成关联记录。
    - 任务列表可按项目/状态筛选。

- **积分汇总与记录**
  - 功能：展示可用积分、已兑换积分；查看积分增加记录与兑换记录。
  - 用户操作：
    - 首页与积分页均可查看汇总；点击“可用积分”打开兑换表单，“已兑换积分”切换到兑换记录标签。
    - 在“增加记录”标签查看奖励来源与时间。

- **积分兑换与奖励/惩罚选项**
  - 功能：积分兑换校验可用积分；自定义奖励选项（名称、所需积分）与惩罚选项。
  - 用户操作：
    - 在积分页“兑换记录”标签点击“新增兑换”，选择奖励选项提交。
    - 在奖励/惩罚设置中新增、编辑、删除选项；提交兑换时自动校验积分余额。

- **AI 语音助手（Web Speech API）**
  - 功能：中文语音输入 → STT → LLM 解析意图 → 预填任务/兑换表单；智能纠错并匹配用户自定义项目/奖励。
  - 用户操作：
    - 在支持语音的浏览器右下角浮动按钮唤起助手，点击“开始语音输入”，说出指令。
    - 示例指令：“语文单元形评获得 A*，奖励 10 积分”（新增任务并预填评分与积分）；“积分兑换 10 元”（打开兑换表单并预填奖励）。
    - 解析成功后点击“确认并跳转”，自动携带 `student_id`、`prefill` 进入对应页面并打开表单。
    - 识别结束 1 秒内自动停止并解析；不支持语音的浏览器隐藏入口，改用手动输入。

- **首页**
  - 功能：展示学生列表、当前学生的积分汇总与任务评分统计，入口快速跳转。
  - 用户操作：选择学生后查看汇总；点击积分入口快速到积分页对应标签。

- **积分页**
  - 功能：积分汇总、增加记录、兑换记录三大标签；可用/已兑换积分可点击跳转。
  - 用户操作：在“积分汇总”点击可用/已兑换积分直达兑换或记录；在“兑换记录”新增兑换；在“增加记录”查看积分来源。

- **兼容性与限制**
  - 功能：主方案使用 Web Speech API；不支持时自动隐藏语音入口，保留文字输入。
  - 用户操作：在微信/钉钉等不支持语音的内核，直接使用文字输入或手动表单。

## 接口与数据
- **认证**：注册、登录、获取当前用户。
- **学生/项目**：列表、创建、更新、删除（项目支持层级）。
- **任务**：列表、创建、更新。
- **积分**：汇总、增加记录、兑换记录、创建兑换；奖励/惩罚选项管理。
- **首页数据**：仪表盘数据。
- **AI**：语音指令解析（文本输入），返回解析意图与预填数据。

## 部署与运行（简版）
- 后端：FastAPI + MySQL，示例 `.env` 需配置数据库、`SECRET_KEY`、CORS。
- 前端：`VITE_API_BASE_URL` 指向后端 `/api/v1`。
- Docker Compose：提供 dev/prod 配置；Nginx 反代。
- AI 服务：需设置 `AI_API_KEY`、`AI_API_BASE_URL`、`AI_MODEL` 环境变量。

## 已知提示与操作引导
- 浏览器不支持语音识别时显示提示，并仅提供文字输入。
- 语音识别失败或无权限时弹出错误提示。
- 路由参数在预填完成后自动清理，避免重复打开表单。


